<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>CUDA Thrust Introduction - Yuanjun&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Yuanjun&#039;s Blog"><meta name="msapplication-TileImage" content="/img/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Yuanjun&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="The introduction about CUDA Thrust."><meta property="og:type" content="blog"><meta property="og:title" content="CUDA Thrust Introduction"><meta property="og:url" content="https://wtffqbpl.github.io/2022/11/22/CUDA-Thrust-Introduction/"><meta property="og:site_name" content="Yuanjun&#039;s Blog"><meta property="og:description" content="The introduction about CUDA Thrust."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://wtffqbpl.github.io/img/cuda/cudathrust.jpeg"><meta property="article:published_time" content="2022-11-22T07:14:42.000Z"><meta property="article:modified_time" content="2022-11-24T15:09:03.931Z"><meta property="article:author" content="Yuanjun Ren"><meta property="article:tag" content="CUDA"><meta property="article:tag" content="Thrust"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://wtffqbpl.github.io/img/cuda/cudathrust.jpeg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wtffqbpl.github.io/2022/11/22/CUDA-Thrust-Introduction/"},"headline":"CUDA Thrust Introduction","image":[],"datePublished":"2022-11-22T07:14:42.000Z","dateModified":"2022-11-24T15:09:03.931Z","author":{"@type":"Person","name":"Yuanjun Ren"},"publisher":{"@type":"Organization","name":"Yuanjun's Blog","logo":{"@type":"ImageObject","url":"https://wtffqbpl.github.io/img/logo.png"}},"description":"The introduction about CUDA Thrust."}</script><link rel="canonical" href="https://wtffqbpl.github.io/2022/11/22/CUDA-Thrust-Introduction/"><link rel="icon" href="/img/logo.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Yuanjun&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/wtffqbpl/wtffqbpl.github.io"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/cuda/cudathrust.jpeg" alt="CUDA Thrust Introduction"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-11-22T07:14:42.000Z" title="11/22/2022, 3:14:42 PM">2022-11-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-11-24T15:09:03.931Z" title="11/24/2022, 11:09:03 PM">2022-11-24</time></span><span class="level-item">4 minutes read (About 579 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">CUDA Thrust Introduction</h1><div class="content"><p>Thrust is analogous to C++ Standard Template Library(STL). The Thrust algorithms can run on both the host and the device.</p>
<p>Sort, scan, reduce, reduce-by-key<br>Transform input vector(s)<br>Eg. vector addition thrust::plus<br>Or you can apply user defined transformation functors.<br>interoperate with CUDA code.</p>
<p>If you don’t need to do something that is not built in to <code>Thrust</code> or that’s difficult to do with <code>Thrust</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">thrust::device_vector&lt;<span class="type">float</span>&gt; <span class="title">X</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line"><span class="type">float</span> result = thrust::<span class="built_in">reduce</span>(X.<span class="built_in">begin</span>(), X.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="type">float</span> init = <span class="number">0.f</span>;</span><br><span class="line"><span class="comment">// We can pass in an operator to use or a functor.</span></span><br><span class="line">result = thrust::<span class="built_in">reduce</span>(X.<span class="built_in">begin</span>(), X.<span class="built_in">end</span>(), init, thrust::<span class="built_in">maximum</span>&lt;<span class="type">float</span>&gt;());</span><br></pre></td></tr></table></figure>

<h2 id="Some-Algorithms"><a href="#Some-Algorithms" class="headerlink" title="Some Algorithms"></a>Some Algorithms</h2><p>These algorithms are existed in thrust, but do not exist in C++ STL library.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">thrust::<span class="built_in">gather</span>();</span><br><span class="line">thrust::<span class="built_in">gather_if</span>();</span><br><span class="line">thrust::<span class="built_in">scatter</span>();</span><br><span class="line">thrust::<span class="built_in">scatter_if</span>();</span><br><span class="line">thrust::<span class="built_in">sequence</span>();</span><br><span class="line">thrust::<span class="built_in">stable_partition_copy</span>();</span><br><span class="line">thrust::<span class="built_in">tabulate</span>();</span><br><span class="line">thrust::<span class="built_in">transform_if</span>();</span><br></pre></td></tr></table></figure>

<h3 id="thrust-sequence"><a href="#thrust-sequence" class="headerlink" title="thrust::sequence()"></a>thrust::sequence()</h3><p>The equivalent of algorithm in STL is <code>std::iota</code>, which is not a good name. <code>Thrust</code> changes this name to <code>sequence</code>. </p>
<p>Some algorithms in <code>&lt;numeric&gt;</code> header. There are 12 by-key-algorithms in thrust. These 12 algorithms are super useful. You can think of them as segmented versions of their corresponding algorithms. So if you have an inclusive scan by key. This is exactly like an inclusive scan but instead of doing it on a whole range you are doing it on segments of a range, which can come in handy in many cases.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">thrust::<span class="built_in">exclusive_scan_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">inclusive_scan_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">merge_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">reduce_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">set_difference_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">set_intersection_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">set_symmetric_difference_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">set_union_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">sort_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">stable_sort_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">unique_by_key</span>();</span><br><span class="line">thrust::<span class="built_in">unique_by_key_copy</span>();</span><br></pre></td></tr></table></figure>

<p>There are three examples that shows how to use these algorithms.</p>
<h2 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem 1"></a>Problem 1</h2><ul>
<li><p>In C++ STL view.</p>
<blockquote>
<p>What is <code>std::iota</code> + <code>std::transform</code>?</p>
</blockquote>
</li>
<li><p>In Thrust view:</p>
<blockquote>
<p>What is <code>thrust::sequence</code> + <code>thrust::transform</code>?</p>
</blockquote>
</li>
</ul>
<p>These two algorithms combined to make a single algorithm: <code>thrust::tabulate</code>. This is very interesting algorithm. Generate the first odd number. For example, generate first 10 odd numbers.</p>
<ul>
<li><p>In C++</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> odds = std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">std::<span class="built_in">iota</span>(odds.<span class="built_in">begin</span>(), odds.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">std::<span class="built_in">transform</span>(</span><br><span class="line">    odds.<span class="built_in">begin</span>(),</span><br><span class="line">    odds.<span class="built_in">end</span>(),</span><br><span class="line">    odds.<span class="built_in">begin</span>(),</span><br><span class="line">    [](<span class="keyword">auto</span> e) &#123; <span class="keyword">return</span> e * <span class="number">2</span> + <span class="number">1</span>; &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>In CUDA With Thrust</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> odds = std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">10</span>);</span><br><span class="line">thrust::<span class="built_in">tabulate</span>(</span><br><span class="line">    odds.<span class="built_in">begin</span>(), odds.<span class="built_in">end</span>(),</span><br><span class="line">    [](<span class="keyword">auto</span> e) &#123; <span class="keyword">return</span> e * <span class="number">2</span> + <span class="number">1</span>; &#125;);</span><br></pre></td></tr></table></figure>
<p>This code is running on the host. And this is very easy to transform this code to device.</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> odds = std::<span class="built_in">device_vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">10</span>);</span><br><span class="line">thrust::<span class="built_in">tabulate</span>(</span><br><span class="line">    odds.<span class="built_in">begin</span>(), odds.<span class="built_in">end</span>(),</span><br><span class="line">    [] __device__ (<span class="keyword">auto</span> e) &#123; <span class="keyword">return</span> e * <span class="number">2</span> + <span class="number">1</span>; &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem 2"></a>Problem 2</h2><blockquote>
<p>Copy every other number.</p>
</blockquote>
<p>The answer is <code>thrust::gather()</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> <span class="type">const</span> deck       = std::vector&lt;<span class="type">int</span>&gt;&#123;<span class="number">13</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> <span class="type">const</span> gather_map = std::vector&lt;<span class="type">int</span>&gt;&#123;<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span>       hand       = std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// deals every second card to hand</span></span><br><span class="line">thrust::<span class="built_in">gather</span>(</span><br><span class="line">    gather_map.<span class="built_in">cbegin</span>(), <span class="comment">// The first two iterators define the gather map.</span></span><br><span class="line">    gather_map.<span class="built_in">cend</span>(),</span><br><span class="line">    deck.<span class="built_in">cbegin</span>(), <span class="comment">// defines source that we are gathering from</span></span><br><span class="line">    hand.<span class="built_in">begin</span>()); <span class="comment">// defines the target that we are gathering to.</span></span><br><span class="line"><span class="comment">// The final results: hand = &#123;13, 14, 6&#125;;</span></span><br></pre></td></tr></table></figure>

<h2 id="Problem-3-—-MCO"><a href="#Problem-3-—-MCO" class="headerlink" title="Problem 3 — MCO"></a>Problem 3 — MCO</h2><blockquote>
<p>Maximum Consecutive Ones</p>
</blockquote>
<p>Using <code>thrust::reduce_by_key()</code> for solve this problem.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 1 1 0 0 1 0 1 1 1 1</span></span><br><span class="line"><span class="comment">// For example, calculates the longest contiguous sequence of ones. In this example, the answer is 4.</span></span><br><span class="line"><span class="keyword">auto</span> <span class="type">const</span> ones = std::vector&lt;<span class="type">int</span>&gt;&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> sums = std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">thrust::<span class="built_in">reduce_by_key</span>(</span><br><span class="line">    ones.<span class="built_in">cbegin</span>(),                    <span class="comment">// keys input</span></span><br><span class="line">    ones.<span class="built_in">cend</span>(),</span><br><span class="line">    ones.<span class="built_in">cbegin</span>(),                    <span class="comment">// values input</span></span><br><span class="line">    thrust::<span class="built_in">make_discard_iterator</span>(),  <span class="comment">// keys output</span></span><br><span class="line">    sums.<span class="built_in">begin</span>());                    <span class="comment">// values output</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> <span class="type">const</span> max = *thrust::<span class="built_in">max_element</span>(</span><br><span class="line">    sums.<span class="built_in">cbegin</span>(), sums.<span class="built_in">cend</span>());</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>CUDA Thrust Introduction</p><p><a href="https://wtffqbpl.github.io/2022/11/22/CUDA-Thrust-Introduction/">https://wtffqbpl.github.io/2022/11/22/CUDA-Thrust-Introduction/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Yuanjun Ren</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-11-22</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-11-24</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CUDA/">CUDA</a><a class="link-muted mr-2" rel="tag" href="/tags/Thrust/">Thrust</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/alipay-qrcode.jpg" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/wechat-qrcode.jpg" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/11/22/Execution-Policy-in-C-17/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Execution Policy in C++17</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/11/17/C-STL-Overview/"><span class="level-item">C++ STL Overview</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "506df407c81984605c0ec830f35e6526",
            repo: "wtffqbpl.github.io",
            owner: "wtffqbpl",
            clientID: "91ed89a1c2b6427b0731",
            clientSecret: "133fc04688d9a06b6d46e34f1e40909bd5780033",
            admin: ["wtffqbpl"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/profile.jpg" alt="Yuanjun Ren"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Yuanjun Ren</p><p class="is-size-6 is-block">C++ Programmer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Xi&#039;an/China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">19</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/wtffqbpl" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/wtffqbpl"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/yuanjun-ren-5a7949bb"><i class="fab fa-linkedin"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Some-Algorithms"><span class="level-left"><span class="level-item">1</span><span class="level-item">Some Algorithms</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#thrust-sequence"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">thrust::sequence()</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Problem-1"><span class="level-left"><span class="level-item">2</span><span class="level-item">Problem 1</span></span></a></li><li><a class="level is-mobile" href="#Problem-2"><span class="level-left"><span class="level-item">3</span><span class="level-item">Problem 2</span></span></a></li><li><a class="level is-mobile" href="#Problem-3-—-MCO"><span class="level-left"><span class="level-item">4</span><span class="level-item">Problem 3 — MCO</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><!--!--><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-14/"><span class="tag">C++14</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-17/"><span class="tag">C++17</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-20/"><span class="tag">C++20</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CMake/"><span class="tag">CMake</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CUB/"><span class="tag">CUB</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CUDA/"><span class="tag">CUDA</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Interview/"><span class="tag">Interview</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LLVM/"><span class="tag">LLVM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Lambda/"><span class="tag">Lambda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Meta-Programming/"><span class="tag">Meta-Programming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Perfect-Forwarding/"><span class="tag">Perfect Forwarding</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RAII/"><span class="tag">RAII</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STL/"><span class="tag">STL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thrust/"><span class="tag">Thrust</span><span class="tag">3</span></a></div></div></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-13T09:18:48.000Z">2023-05-13</time></p><p class="title"><a href="/2023/05/13/perfect-Forwarding/">Perfect Forwarding</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-13T05:30:31.000Z">2023-05-13</time></p><p class="title"><a href="/2023/05/13/cpp-std-functional/">C++ functional Library Introduction</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-13T05:24:37.000Z">2023-05-13</time></p><p class="title"><a href="/2023/05/13/RAII/">RAII</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-13T03:53:14.000Z">2023-05-13</time></p><p class="title"><a href="/2023/05/13/CRTP/">Curiously Recurring Template Pattern --- CRTP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-13T03:14:52.000Z">2023-05-13</time></p><p class="title"><a href="/2023/05/13/C-Interview-Questions/">C++ Interview Questions</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://coderchenlin.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Lin&#039;s Blog</span></span><span class="level-right"><span class="level-item tag">coderchenlin.github.io</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Yuanjun&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Yuanjun Ren</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/wtffqbpl/wtffqbpl.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><style>.searchbox .searchbox-body { background: white; }</style><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"><gcse:searchresults-only></gcse:searchresults-only></div></div><script>(function() {
            var cx = 'd795d66993bb247ae';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
        })();</script></div><script src="/js/google_cse.js"></script></body></html>